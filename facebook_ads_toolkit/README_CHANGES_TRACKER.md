# Инструмент отслеживания изменений в рекламном кабинете Facebook

Этот инструмент позволяет отслеживать и анализировать изменения, внесенные в рекламный кабинет Facebook за указанный период времени. С его помощью вы можете узнать, кто и когда вносил изменения в рекламные кампании, группы объявлений и объявления.

## Возможности

- Получение активности по рекламному аккаунту
- Отслеживание изменений в рекламных кампаниях
- Отслеживание изменений в группах объявлений
- Отслеживание изменений в объявлениях
- Анализ активности пользователей
- Формирование отчетов об изменениях
- Кэширование результатов для ускорения работы

## Требования

- Python 3.6+
- Facebook Business SDK
- Доступ к Facebook Ads API (токен доступа)
- ID рекламного аккаунта

## Установка

1. Убедитесь, что у вас установлен Python 3.6 или выше
2. Установите необходимые зависимости:

```bash
pip install facebook-business python-dotenv
```

## Настройка

Для работы с API Facebook вам потребуется:

1. Токен доступа к Facebook Ads API
2. ID вашего рекламного аккаунта

Эти данные можно указать:
- В файле `.env` в директории `facebook_ads_toolkit/config/`
- Передать напрямую в командной строке при запуске скрипта

Пример содержимого файла `.env`:

```
FB_APP_ID=ваш_app_id
FB_APP_SECRET=ваш_app_secret
FB_ACCESS_TOKEN=ваш_токен_доступа
FB_ACCOUNT_ID=ваш_id_аккаунта
```

## Использование

### Получение активности по аккаунту

```bash
python -m facebook_ads_toolkit.cli.track_changes --days 14 --use-cache
```

### Получение изменений для конкретной кампании

```bash
python -m facebook_ads_toolkit.cli.track_changes --campaign-id 123456789 --days 14 --use-cache
```

### Получение изменений для группы объявлений

```bash
python -m facebook_ads_toolkit.cli.track_changes --adset-id 123456789 --days 14 --use-cache
```

### Получение изменений для объявления

```bash
python -m facebook_ads_toolkit.cli.track_changes --ad-id 123456789 --days 14 --use-cache
```

### Получение полного отчета по всем изменениям

```bash
python -m facebook_ads_toolkit.cli.track_changes --full-report --days 14 --use-cache
```

## Параметры командной строки

| Параметр | Описание |
|----------|----------|
| `--days` | Количество дней для анализа (по умолчанию 14) |
| `--output-dir` | Директория для сохранения отчетов (по умолчанию 'reports') |
| `--use-cache` | Использовать кэширование |
| `--clear-cache` | Очистить кэш перед запуском |
| `--debug` | Включить расширенное логирование |
| `--access-token` | Токен доступа к API Facebook |
| `--account-id` | ID рекламного аккаунта |
| `--campaign-id` | ID конкретной кампании для анализа |
| `--adset-id` | ID конкретной группы объявлений для анализа |
| `--ad-id` | ID конкретного объявления для анализа |
| `--full-report` | Получить полный отчет по всем изменениям |

## Формат отчетов

Отчеты сохраняются в формате JSON в указанной директории (по умолчанию 'reports'). Имя файла содержит тип отчета и дату его создания.

### Пример отчета по активности аккаунта

```json
{
  "total_activities": 150,
  "total_campaign_changes": 45,
  "total_adset_changes": 78,
  "total_ad_changes": 120,
  "campaigns_modified": [
    {
      "id": "123456789",
      "name": "Название кампании",
      "changes_count": 15,
      "last_change": "2025-02-20T12:34:56+0000"
    },
    ...
  ],
  "adsets_modified": [...],
  "ads_modified": [...],
  "users_activity": {
    "Имя Пользователя": 45,
    "Другой Пользователь": 30,
    ...
  }
}
```

## Примеры использования

### Сценарий 1: Аудит изменений за последние 2 недели

```bash
python -m facebook_ads_toolkit.cli.track_changes --days 14 --use-cache
```

Этот сценарий позволяет получить общую картину активности в рекламном кабинете за последние 2 недели, включая информацию о том, кто вносил изменения и какие объекты были изменены.

### Сценарий 2: Детальный анализ изменений в конкретной кампании

```bash
python -m facebook_ads_toolkit.cli.track_changes --campaign-id 123456789 --days 30 --use-cache
```

Этот сценарий позволяет получить детальную информацию о всех изменениях, внесенных в конкретную кампанию за последний месяц.

### Сценарий 3: Полный аудит всех изменений

```bash
python -m facebook_ads_toolkit.cli.track_changes --full-report --days 30 --use-cache --output-dir audit_reports
```

Этот сценарий создает полный отчет о всех изменениях во всех объектах рекламного кабинета за последний месяц и сохраняет его в директории 'audit_reports'.

## Устранение неполадок

### Ошибка доступа к API

Если вы получаете ошибку доступа к API, убедитесь, что:
1. Ваш токен доступа действителен и не истек
2. У вас есть необходимые разрешения для доступа к рекламному аккаунту
3. ID рекламного аккаунта указан правильно (должен начинаться с 'act_')

### Ошибка "Object with ID does not exist"

Эта ошибка может возникать, если:
1. Указанный ID объекта (кампании, группы объявлений или объявления) не существует
2. У вас нет доступа к этому объекту
3. Объект был удален

## Дополнительная информация

Для получения дополнительной информации о Facebook Ads API посетите [официальную документацию](https://developers.facebook.com/docs/marketing-apis/). 