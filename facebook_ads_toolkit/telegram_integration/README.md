# Интеграция Facebook Ads Toolkit с Telegram

Этот модуль обеспечивает интеграцию Facebook Ads Toolkit с мессенджером Telegram, позволяя получать отчеты о рекламных кампаниях и управлять ими через Telegram-бота.

## Возможности

- Получение ежедневных отчетов о рекламных кампаниях
- Анализ эффективности кампаний
- Уведомления о проблемах с кампаниями
- Просмотр списка активных кампаний
- Получение детальной информации о конкретной кампании

## Настройка

### Предварительные требования

- Python 3.7+
- Токен Telegram-бота (получить у [@BotFather](https://t.me/BotFather))
- ID канала или чата для отправки уведомлений

### Установка зависимостей

```bash
pip install python-telegram-bot>=20.4
```

### Конфигурация

Добавьте следующие переменные в файл `.env` в корневой директории проекта:

```
# Telegram Configuration
TELEGRAM_BOT_TOKEN=ваш_токен_от_BotFather
TELEGRAM_LOG_CHANNEL_ID=id_канала_для_логов
TELEGRAM_AUTHORIZED_USERS=id1,id2,id3  # Опционально, список ID пользователей, которым разрешено использовать бота
```

## Использование

### Запуск бота

```bash
python -m facebook_ads_toolkit.telegram_bot
```

### Команды бота

- `/start` - Начало работы с ботом
- `/help` - Показать справку
- `/report [дни]` - Получить ежедневный отчет (по умолчанию за 1 день)
- `/performance [дни]` - Отчет о производительности кампаний (по умолчанию за 7 дней)
- `/campaign ID` - Информация о конкретной кампании
- `/list` - Список активных кампаний

### Программное использование

```python
from facebook_ads_toolkit.telegram_integration import TelegramBot, TelegramReportSender

# Отправка сообщения
bot = TelegramBot()
await bot.send_message("Привет, это тестовое сообщение!")

# Отправка отчета
report_sender = TelegramReportSender()
await report_sender.send_daily_report(days=7)
```

## Структура модуля

- `__init__.py` - Инициализация модуля
- `bot.py` - Основной класс для работы с Telegram API
- `config.py` - Настройки и конфигурация
- `handlers.py` - Обработчики команд бота
- `report_sender.py` - Класс для форматирования и отправки отчетов
- `templates/` - Директория с шаблонами сообщений

## Шаблоны сообщений

Шаблоны сообщений хранятся в файле `templates/message_templates.yaml` и могут быть изменены без изменения кода.

## Расширение функциональности

Для добавления новых команд:

1. Создайте обработчик команды в файле `handlers.py`
2. Добавьте обработчик в функцию `setup_handlers()`
3. При необходимости добавьте новый шаблон в `templates/message_templates.yaml`

## Логирование

Логи работы бота сохраняются в директории `logs/`:
- `telegram_bot.log` - Логи основного класса бота
- `telegram_handlers.log` - Логи обработчиков команд
- `telegram_reports.log` - Логи отправки отчетов
- `telegram_config.log` - Логи конфигурации

## Устранение неполадок

### Бот не отвечает на команды

1. Проверьте, что бот запущен
2. Убедитесь, что токен бота указан правильно
3. Проверьте логи на наличие ошибок

### Ошибка при отправке отчета

1. Проверьте, что ID канала указан правильно
2. Убедитесь, что бот имеет права администратора в канале
3. Проверьте логи на наличие ошибок при генерации отчета 